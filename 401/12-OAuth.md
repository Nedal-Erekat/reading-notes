# OAthu

## Authorization
- Create a random string between 43-128 characters long, then generate the url-safe base64-encoded SHA256 hash of the string. The original random string is known as the `code_verifier`, and the hashed version is known as the `code_challenge`.

```
 > Create a random string (code verifier), e.g. 5d2309e5bb73b864f989753887fe52f79ce5270395e25862da6940d5

 > Create the SHA256 hash, then base64-encode the string (code challenge): MChCW5vD-3h03HMGFZYskOSTir7II_MMTb8a9rJNhnI
```
- Create a "Log In" link like the authorization code flow above, but now include the code challenge in the request

> https://authorization-server.com/auth?response_type=code&
  client_id=CLIENT_ID&redirect_uri=REDIRECT_URI&scope=photos&state=1234zyx&code_challenge=CODE_CHALLENGE&code_challenge_method=S256

 - response_type=code - Indicates that your server expects to receive an authorization code
 - client_id - The client ID you received when you first created the application
 - redirect_uri - Indicates the URI to return the user to after authorization is complete
 - scope - One or more scope values indicating which parts of the user's account you wish to access
 - state - A random string generated by your application, which you'll verify later
 - code_challenge - The URL-safe base64-encoded SHA256 hash of the secret
 - code_challenge_method=S256 - Indicate which hashing method you used (S256)

- The user sees the authorization prompt,If the user clicks "Allow," the service redirects the user back to your site with an auth code

 > https://example-app.com/cb?code=AUTH_CODE_HERE&state=1234zyx
  - code - The server returns the authorization code in the query string
  - state - The server returns the same state value that you passed

![](https://aaronparecki.com/oauth-2-simplified/oauth-authorization-prompt.png)


### Getting an Access Token

The authorization server will hash the verifier and compare it to the challenge sent in the request, and only issue the access token if they match. 